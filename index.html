<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MangiaFortissimo</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* Basic Styles */
        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f4f4;
        }

        h1, h2 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        /* Search and Target Inputs */
        .search-target-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
        }

        #foodSearch, .target-input {
            padding: 10px 15px;
            border: none;
            border-radius: 20px;
            background-color: #f0f0f0;
            font-size: 16px;
            flex: 1;
            min-width: 200px;
        }

        .target-input {
            max-width: 200px;
        }

        /* Toggle Buttons (Categories) */
        .toggle-buttons {
            display: flex;
            overflow-x: auto;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 10px;
        }

        .toggle-button {
            padding: 10px 15px;
            background-color: #f0f0f0;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: background-color 0.3s;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .toggle-button.active {
            background-color: #3498db;
            color: white;
        }

        /* Food Buttons */
        #foodButtons {
            display: flex;
            overflow-x: auto;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 10px;
        }

        .food-button {
            padding: 10px 15px;
            background-color: #f0f0f0;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: background-color 0.3s;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .food-button.active {
            background-color: #2ecc71;
            color: white;
        }

        /* Selected Foods (Sliders) */
        #selectedFoods {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .food-item {
            background-color: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .food-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .food-item input[type="range"] {
            width: 100%;
        }

        /* Dashboard - Macronutrients */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .progress-section {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
            position: relative;
        }

        .progress-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            position: relative;
            margin: 0 auto 10px;
            background: conic-gradient(
                #3498db calc(var(--progress) * 1%),
                #e0e0e0 0%
            );
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }

        .progress-circle::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 10px;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: #fff;
        }

        .progress-circle .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #555;
            font-size: 18px;
            font-weight: bold;
        }

        .sub-nutrients {
            margin-top: 10px;
            font-size: 14px;
            color: #555;
        }

        /* Dashboard - Vitamins and Minerals */
        .progress-bars-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 20px;
        }

        .progress-bar-section {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .progress-bar-section h2 {
            margin-bottom: 15px;
        }

        .progress-bar {
            position: relative;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .progress-bar::before {
            content: attr(data-label);
            position: absolute;
            left: 10px;
            top: -25px;
            color: #333;
            font-size: 14px;
        }

        .progress-bar::after {
            content: attr(data-value) "% (" attr(data-current) " / " attr(data-total) ")";
            position: absolute;
            right: 10px;
            top: -25px;
            color: #333;
            font-size: 14px;
        }

        .progress-bar-fill {
            background-color: #3498db;
            height: 100%;
            border-radius: 10px 0 0 10px;
            width: 0%;
            transition: width 0.3s ease;
        }

        .top-contributors {
            margin-top: 5px;
            font-size: 12px;
            color: #555;
        }

        .top-contributors span {
            margin-right: 10px;
        }

        /* Footer */
        footer {
            text-align: center;
            margin-top: 40px;
            font-size: 14px;
            color: #777;
        }

        footer a {
            color: #3498db;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            }

            .progress-circle {
                width: 100px;
                height: 100px;
            }

            .progress-circle::before {
                width: 80px;
                height: 80px;
            }
        }
    </style>
</head>
<body>
    <h1>MangiaFortissimo</h1>

    <div class="search-target-container">
        <input type="text" id="foodSearch" placeholder="Search foods...">
        <input type="number" id="targetCalories" class="target-input" placeholder="Target Kcal" min="0">
        <input type="number" id="targetProtein" class="target-input" placeholder="Target Protein (g)" min="0">
        <input type="number" id="targetFiber" class="target-input" placeholder="Target Fiber (g)" min="0">
    </div>

    <div class="toggle-buttons">
        <button class="toggle-button active" data-category="all">All üçé</button>
        <button class="toggle-button" data-category="fruits">Fruits üçì</button>
        <button class="toggle-button" data-category="vegetables">Vegetables ü•¶</button>
        <button class="toggle-button" data-category="dairy">Dairy ü•õ</button>
        <button class="toggle-button" data-category="grains">Grains üåæ</button>
        <button class="toggle-button" data-category="protein">Protein ü•©</button>
        <button class="toggle-button" data-category="others">Others üçï</button>
    </div>

    <div id="foodButtons"></div>
    <div id="selectedFoods"></div>

    <div class="dashboard">
        <!-- Macronutrient Progress Circles -->
        <div class="progress-section">
            <h2>Calories</h2>
            <div id="caloriesProgress" class="progress-circle">
                <div class="progress-text" id="caloriesText">0%</div>
            </div>
            <div class="sub-nutrients">
                <!-- Additional info can be added here if needed -->
            </div>
        </div>
        <div class="progress-section">
            <h2>Protein</h2>
            <div id="proteinProgress" class="progress-circle">
                <div class="progress-text" id="proteinText">0%</div>
            </div>
            <div class="sub-nutrients">
                <!-- Additional info can be added here if needed -->
            </div>
        </div>
        <div class="progress-section">
            <h2>Carbs</h2>
            <div id="carbsProgress" class="progress-circle">
                <div class="progress-text" id="carbsText">0%</div>
            </div>
            <div class="sub-nutrients" id="carbsSubNutrients">
                Sugar: 0g | Fiber: 0g
            </div>
        </div>
        <div class="progress-section">
            <h2>Fat</h2>
            <div id="fatProgress" class="progress-circle">
                <div class="progress-text" id="fatText">0%</div>
            </div>
            <div class="sub-nutrients" id="fatSubNutrients">
                Saturated: 0g | Unsaturated: 0g | Omega-3: 0g | Omega-6: 0g
            </div>
        </div>
    </div>

    <div class="progress-bars-section">
        <!-- Vitamins Progress Bars -->
        <div class="progress-bar-section">
            <h2>Vitamins</h2>
            <div class="progress-bar" id="vitaminAProgressBar" data-label="Vitamin A" data-current="0" data-total="900">
                <div class="progress-bar-fill"></div>
            </div>
            <div class="top-contributors" id="vitaminATop">
                <!-- Top contributors for Vitamin A will be displayed here -->
            </div>

            <div class="progress-bar" id="vitaminB12ProgressBar" data-label="Vitamin B12" data-current="0" data-total="2.4">
                <div class="progress-bar-fill"></div>
            </div>
            <div class="top-contributors" id="vitaminB12Top">
                <!-- Top contributors for Vitamin B12 will be displayed here -->
            </div>

            <div class="progress-bar" id="vitaminCProgressBar" data-label="Vitamin C" data-current="0" data-total="90">
                <div class="progress-bar-fill"></div>
            </div>
            <div class="top-contributors" id="vitaminCTop">
                <!-- Top contributors for Vitamin C will be displayed here -->
            </div>

            <div class="progress-bar" id="vitaminDProgressBar" data-label="Vitamin D" data-current="0" data-total="20">
                <div class="progress-bar-fill"></div>
            </div>
            <div class="top-contributors" id="vitaminDTop">
                <!-- Top contributors for Vitamin D will be displayed here -->
            </div>

            <div class="progress-bar" id="vitaminEProgressBar" data-label="Vitamin E" data-current="0" data-total="15">
                <div class="progress-bar-fill"></div>
            </div>
            <div class="top-contributors" id="vitaminETop">
                <!-- Top contributors for Vitamin E will be displayed here -->
            </div>

            <div class="progress-bar" id="vitaminKProgressBar" data-label="Vitamin K" data-current="0" data-total="120">
                <div class="progress-bar-fill"></div>
            </div>
            <div class="top-contributors" id="vitaminKTop">
                <!-- Top contributors for Vitamin K will be displayed here -->
            </div>
        </div>

        <!-- Minerals Progress Bars -->
        <div class="progress-bar-section">
            <h2>Minerals</h2>
            <div class="progress-bar" id="calciumProgressBar" data-label="Calcium" data-current="0" data-total="1000">
                <div class="progress-bar-fill"></div>
            </div>
            <div class="top-contributors" id="calciumTop">
                <!-- Top contributors for Calcium will be displayed here -->
            </div>

            <div class="progress-bar" id="magnesiumProgressBar" data-label="Magnesium" data-current="0" data-total="420">
                <div class="progress-bar-fill"></div>
            </div>
            <div class="top-contributors" id="magnesiumTop">
                <!-- Top contributors for Magnesium will be displayed here -->
            </div>

            <div class="progress-bar" id="potassiumProgressBar" data-label="Potassium" data-current="0" data-total="4700">
                <div class="progress-bar-fill"></div>
            </div>
            <div class="top-contributors" id="potassiumTop">
                <!-- Top contributors for Potassium will be displayed here -->
            </div>

            <div class="progress-bar" id="ironProgressBar" data-label="Iron" data-current="0" data-total="18">
                <div class="progress-bar-fill"></div>
            </div>
            <div class="top-contributors" id="ironTop">
                <!-- Top contributors for Iron will be displayed here -->
            </div>

            <div class="progress-bar" id="zincProgressBar" data-label="Zinc" data-current="0" data-total="11">
                <div class="progress-bar-fill"></div>
            </div>
            <div class="top-contributors" id="zincTop">
                <!-- Top contributors for Zinc will be displayed here -->
            </div>

            <div class="progress-bar" id="seleniumProgressBar" data-label="Selenium" data-current="0" data-total="55">
                <div class="progress-bar-fill"></div>
            </div>
            <div class="top-contributors" id="seleniumTop">
                <!-- Top contributors for Selenium will be displayed here -->
            </div>

            <div class="progress-bar" id="sodiumProgressBar" data-label="Sodium" data-current="0" data-total="2300">
                <div class="progress-bar-fill"></div>
            </div>
            <div class="top-contributors" id="sodiumTop">
                <!-- Top contributors for Sodium will be displayed here -->
            </div>
        </div>
    </div>

    <footer>
        <p>micmer - <a href="https://linktr.ee/micmer">https://linktr.ee/micmer</a></p>
    </footer>

    <script>
        // Food Data
        const foodData = {
            "Banana (1 medium)": { emoji: "üçå", grams: 120, calories: 105, totalFat: 0.4, saturatedFat: 0.1, monounsaturatedFat: 0.1, polyunsaturatedFat: 0.1, omega3: 0, omega6: 30, carbs: 27, sugar: 14, protein: 1.3, fiber: 3.1, vitaminC: 10, potassium: 422, category: "fruits" },
            "Apple (1 medium)": { emoji: "üçé", grams: 182, calories: 95, totalFat: 0.3, saturatedFat: 0, monounsaturatedFat: 0.1, polyunsaturatedFat: 0.1, omega3: 3, omega6: 40, carbs: 25, sugar: 19, protein: 0.5, fiber: 4.4, vitaminC: 8, potassium: 195, category: "fruits" },
            "Greek Yogurt (1 cup)": { emoji: "ü•õ", grams: 170, calories: 100, totalFat: 0, saturatedFat: 0, monounsaturatedFat: 0, polyunsaturatedFat: 0, omega3: 0, omega6: 0, carbs: 6, sugar: 6, protein: 17, fiber: 0, calcium: 10, potassium: 0, category: "dairy" },
            "Cappuccino (1 cup)": { emoji: "‚òï", grams: 240, calories: 110, totalFat: 5, saturatedFat: 3, monounsaturatedFat: 1.5, polyunsaturatedFat: 0.5, omega3: 0, omega6: 0, carbs: 12, sugar: 12, protein: 8, fiber: 1, calcium: 30, potassium: 0, category: "dairy" },
            "Egg (1 large)": { emoji: "ü•ö", grams: 50, calories: 78, totalFat: 5.3, saturatedFat: 1.6, monounsaturatedFat: 2.0, polyunsaturatedFat: 0.7, omega3: 37, omega6: 570, carbs: 0.6, sugar: 0, protein: 6.3, fiber: 0, vitaminD: 1, potassium: 69, category: "protein" },
            "Bread (1 slice)": { emoji: "üçû", grams: 30, calories: 80, totalFat: 1, saturatedFat: 0.2, monounsaturatedFat: 0.3, polyunsaturatedFat: 0.3, omega3: 0, omega6: 0, carbs: 15, sugar: 1, protein: 3, fiber: 1, iron: 6, potassium: 0, category: "grains" },
            "Honey (1 tablespoon)": { emoji: "üçØ", grams: 21, calories: 64, totalFat: 0, saturatedFat: 0, monounsaturatedFat: 0, polyunsaturatedFat: 0, omega3: 0, omega6: 0, carbs: 17, sugar: 17, protein: 0.1, fiber: 0, calcium: 1, potassium: 11, category: "others" },
            "Sweet Potato (1 medium)": { emoji: "üç†", grams: 114, calories: 103, totalFat: 0.1, saturatedFat: 0, monounsaturatedFat: 0, polyunsaturatedFat: 0.1, omega3: 0, omega6: 30, carbs: 24, sugar: 7, protein: 2, fiber: 3.8, vitaminA: 100, potassium: 542, category: "vegetables" },
            "Olive Oil (1 tablespoon)": { emoji: "ü´í", grams: 14, calories: 119, totalFat: 14, saturatedFat: 2, monounsaturatedFat: 10, polyunsaturatedFat: 1.5, omega3: 0, omega6: 1000, carbs: 0, sugar: 0, protein: 0, fiber: 0, vitaminE: 15, potassium: 0, category: "others" },
            "Chicken Breast (3 oz)": { emoji: "üçó", grams: 85, calories: 140, totalFat: 3, saturatedFat: 1, monounsaturatedFat: 1, polyunsaturatedFat: 0.5, omega3: 30, omega6: 1500, carbs: 0, sugar: 0, protein: 26, fiber: 0, vitaminB6: 20, potassium: 220, category: "protein" },
            "Salmon (3 oz)": { emoji: "üêü", grams: 85, calories: 175, totalFat: 11, saturatedFat: 2.5, monounsaturatedFat: 4, polyunsaturatedFat: 3.5, omega3: 1700, omega6: 300, carbs: 0, sugar: 0, protein: 20, fiber: 0, vitaminB12: 80, potassium: 360, category: "protein" },
            "Avocado (1/2 medium)": { emoji: "ü•ë", grams: 100, calories: 160, totalFat: 15, saturatedFat: 2, monounsaturatedFat: 10, polyunsaturatedFat: 2.5, omega3: 160, omega6: 1960, carbs: 9, sugar: 1, protein: 2, fiber: 7, vitaminK: 26, potassium: 485, category: "fruits" },
            "Spinach (1 cup cooked)": { emoji: "ü•¨", grams: 180, calories: 41, totalFat: 0.7, saturatedFat: 0.1, monounsaturatedFat: 0.1, polyunsaturatedFat: 0.3, omega3: 370, omega6: 150, carbs: 7, sugar: 0.5, protein: 5, fiber: 4, vitaminA: 200, potassium: 839, category: "vegetables" },
            "Almonds (1 oz)": { emoji: "ü•ú", grams: 28, calories: 164, totalFat: 14, saturatedFat: 1, monounsaturatedFat: 9, polyunsaturatedFat: 3.5, omega3: 0, omega6: 3680, carbs: 6, sugar: 1.2, protein: 6, fiber: 3.5, vitaminE: 35, magnesium: 20, category: "protein" },
            "Quinoa (1 cup cooked)": { emoji: "üåæ", grams: 185, calories: 222, totalFat: 3.5, saturatedFat: 0.4, monounsaturatedFat: 0.6, polyunsaturatedFat: 1.9, omega3: 47, omega6: 340, carbs: 39, sugar: 1.6, protein: 8, fiber: 5, iron: 15, magnesium: 30, category: "grains" },
            "Broccoli (1 cup chopped)": { emoji: "ü•¶", grams: 91, calories: 31, totalFat: 0.4, saturatedFat: 0.1, monounsaturatedFat: 0, polyunsaturatedFat: 0.2, omega3: 33, omega6: 70, carbs: 6, sugar: 1.5, protein: 3, fiber: 2, vitaminC: 135, potassium: 316, category: "vegetables" },
            "Strawberries (1 cup sliced)": { emoji: "üçì", grams: 150, calories: 46, totalFat: 0.4, saturatedFat: 0, monounsaturatedFat: 0, polyunsaturatedFat: 0.2, omega3: 24, omega6: 40, carbs: 11, sugar: 7, protein: 1, fiber: 3, vitaminC: 98, potassium: 220, category: "fruits" },
            "Oatmeal (1 cup cooked)": { emoji: "ü•£", grams: 234, calories: 147, totalFat: 2.5, saturatedFat: 0.5, monounsaturatedFat: 0.7, polyunsaturatedFat: 0.7, omega3: 55, omega6: 600, carbs: 27, sugar: 1, protein: 5, fiber: 4, iron: 10, potassium: 0, category: "grains" },
            "Tofu (3 oz)": { emoji: "üßä", grams: 85, calories: 70, totalFat: 4, saturatedFat: 0.5, monounsaturatedFat: 1.5, polyunsaturatedFat: 1.5, omega3: 80, omega6: 450, carbs: 2, sugar: 0.3, protein: 8, fiber: 1, calcium: 10, potassium: 120, category: "protein" },
            "Whole Milk (1 cup)": { emoji: "ü•õ", grams: 240, calories: 149, totalFat: 8, saturatedFat: 5, monounsaturatedFat: 2, polyunsaturatedFat: 0.5, omega3: 30, omega6: 200, carbs: 12, sugar: 12, protein: 8, fiber: 0, vitaminD: 15, calcium: 30, category: "dairy" },
            "Brown Rice (1 cup cooked)": { emoji: "üçö", grams: 195, calories: 216, totalFat: 1.8, saturatedFat: 0.4, monounsaturatedFat: 0.5, polyunsaturatedFat: 0.7, omega3: 0, omega6: 50, carbs: 45, sugar: 0.7, protein: 5, fiber: 3, magnesium: 11, potassium: 84, category: "grains" },
            "Lentils (1 cup cooked)": { emoji: "üç≤", grams: 198, calories: 230, totalFat: 0.8, saturatedFat: 0.1, monounsaturatedFat: 0.2, polyunsaturatedFat: 0.4, omega3: 0, omega6: 80, carbs: 40, sugar: 1, protein: 18, fiber: 16, iron: 37, potassium: 731, category: "protein" },
            "Orange (1 medium)": { emoji: "üçä", grams: 131, calories: 62, totalFat: 0.2, saturatedFat: 0, monounsaturatedFat: 0, polyunsaturatedFat: 0.1, omega3: 0, omega6: 20, carbs: 15, sugar: 12, protein: 1, fiber: 3, vitaminC: 100, potassium: 237, category: "fruits" },
            "Carrot (1 medium)": { emoji: "ü•ï", grams: 61, calories: 25, totalFat: 0.2, saturatedFat: 0, monounsaturatedFat: 0, polyunsaturatedFat: 0.1, omega3: 0, omega6: 40, carbs: 6, sugar: 3, protein: 1, fiber: 2, vitaminA: 200, potassium: 230, category: "vegetables" },
            "Peanut Butter (2 tablespoons)": { emoji: "ü•ú", grams: 32, calories: 188, totalFat: 16, saturatedFat: 3, monounsaturatedFat: 8, polyunsaturatedFat: 4, omega3: 0, omega6: 3400, carbs: 7, sugar: 3, protein: 8, fiber: 2, magnesium: 10, potassium: 210, category: "protein" },
            "Walnuts (1 oz)": { emoji: "üå∞", grams: 28, calories: 185, totalFat: 18, saturatedFat: 1.5, monounsaturatedFat: 2.5, polyunsaturatedFat: 13, omega3: 2500, omega6: 3700, carbs: 4, sugar: 1, protein: 4, fiber: 2, magnesium: 10, potassium: 125, category: "protein" },
            "Dark Chocolate (1 oz)": { emoji: "üç´", grams: 28, calories: 155, totalFat: 9, saturatedFat: 5, monounsaturatedFat: 3, polyunsaturatedFat: 0.5, omega3: 0, omega6: 0, carbs: 13, sugar: 12, protein: 2, fiber: 3, iron: 12, magnesium: 25, category: "others" },
            "Kidney Beans (1 cup cooked)": { emoji: "ü´ò", grams: 177, calories: 215, totalFat: 0.5, saturatedFat: 0, monounsaturatedFat: 0.1, polyunsaturatedFat: 0.2, omega3: 0, omega6: 110, carbs: 39, sugar: 0.5, protein: 13, fiber: 11, iron: 20, potassium: 600, category: "protein" },
            "Tuna (3 oz canned in water)": { emoji: "üêü", grams: 85, calories: 94, totalFat: 0.5, saturatedFat: 0.1, monounsaturatedFat: 0.1, polyunsaturatedFat: 0.2, omega3: 250, omega6: 30, carbs: 0, sugar: 0, protein: 20, fiber: 0, vitaminB12: 40, potassium: 0, category: "protein" },
            "Chicken Thigh (3 oz)": { emoji: "üçó", grams: 85, calories: 209, totalFat: 13, saturatedFat: 4, monounsaturatedFat: 6, polyunsaturatedFat: 2, omega3: 40, omega6: 2000, carbs: 0, sugar: 0, protein: 26, fiber: 0, iron: 5, potassium: 210, category: "protein" },
            "Beef (Ground, 80% lean, 3 oz)": { emoji: "ü•©", grams: 85, calories: 215, totalFat: 14, saturatedFat: 6, monounsaturatedFat: 6, polyunsaturatedFat: 1, omega3: 40, omega6: 300, carbs: 0, sugar: 0, protein: 26, fiber: 0, iron: 15, zinc: 45, category: "protein" },
            "Pork Chop (3 oz)": { emoji: "üçñ", grams: 85, calories: 179, totalFat: 8, saturatedFat: 3, monounsaturatedFat: 3.5, polyunsaturatedFat: 1, omega3: 30, omega6: 1000, carbs: 0, sugar: 0, protein: 26, fiber: 0, thiamin: 40, potassium: 370, category: "protein" },
            "Shrimp (3 oz)": { emoji: "ü¶ê", grams: 85, calories: 84, totalFat: 0.5, saturatedFat: 0.1, monounsaturatedFat: 0.2, polyunsaturatedFat: 0.1, omega3: 100, omega6: 100, carbs: 0, sugar: 0, protein: 20, fiber: 0, vitaminB12: 20, selenium: 40, category: "protein" },
            "Cod (3 oz)": { emoji: "üêü", grams: 85, calories: 82, totalFat: 0.5, saturatedFat: 0.1, monounsaturatedFat: 0.1, polyunsaturatedFat: 0.2, omega3: 200, omega6: 30, carbs: 0, sugar: 0, protein: 19, fiber: 0, vitaminB12: 15, selenium: 30, category: "protein" },
            "Pizza (1 slice, cheese)": { emoji: "üçï", grams: 107, calories: 285, totalFat: 10, saturatedFat: 4.5, monounsaturatedFat: 3, polyunsaturatedFat: 1.5, omega3: 0, omega6: 0, carbs: 36, sugar: 3, protein: 12, fiber: 3, calcium: 18, sodium: 640, category: "others" },
            "Pasta (1 cup cooked)": { emoji: "üçù", grams: 140, calories: 221, totalFat: 1.3, saturatedFat: 0.3, monounsaturatedFat: 0.4, polyunsaturatedFat: 0.3, omega3: 0, omega6: 40, carbs: 43, sugar: 1, protein: 8, fiber: 2.5, iron: 6, potassium: 0, category: "grains" },
            "French Fries (medium)": { emoji: "üçü", grams: 117, calories: 312, totalFat: 15, saturatedFat: 2, monounsaturatedFat: 7, polyunsaturatedFat: 4.5, omega3: 0, omega6: 0, carbs: 41, sugar: 0, protein: 4, fiber: 4, vitaminC: 10, potassium: 480, category: "others" },
            "Hamburger (1 patty)": { emoji: "üçî", grams: 113, calories: 303, totalFat: 17, saturatedFat: 6, monounsaturatedFat: 7, polyunsaturatedFat: 2.5, omega3: 30, omega6: 1200, carbs: 0, sugar: 0, protein: 25, fiber: 0, iron: 20, zinc: 50, category: "protein" },
            "Ice Cream (1/2 cup)": { emoji: "üç¶", grams: 68, calories: 137, totalFat: 7, saturatedFat: 4.5, monounsaturatedFat: 2, polyunsaturatedFat: 0.3, omega3: 0, omega6: 0, carbs: 16, sugar: 16, protein: 3, fiber: 0, calcium: 10, potassium: 0, category: "dairy" },
            "Potato Chips (1 oz)": { emoji: "ü•î", grams: 28, calories: 152, totalFat: 10, saturatedFat: 1.5, monounsaturatedFat: 5, polyunsaturatedFat: 3, omega3: 0, omega6: 0, carbs: 15, sugar: 10, protein: 2, fiber: 1, vitaminC: 10, sodium: 170, category: "others" },
            "Popcorn (air-popped, 3 cups)": { emoji: "üçø", grams: 24, calories: 93, totalFat: 1, saturatedFat: 0.2, monounsaturatedFat: 0.3, polyunsaturatedFat: 0.3, omega3: 0, omega6: 300, carbs: 19, sugar: 0.5, protein: 3, fiber: 4, iron: 6, magnesium: 10, category: "grains" },
            "Banana Bread (1 slice)": { emoji: "üçå", grams: 70, calories: 250, totalFat: 10, saturatedFat: 3, monounsaturatedFat: 4, polyunsaturatedFat: 2, omega3: 0, omega6: 0, carbs: 35, sugar: 14, protein: 3, fiber: 1, calcium: 5, potassium: 150, category: "grains" },
            "Granola Bar (1 bar)": { emoji: "üç´", grams: 35, calories: 150, totalFat: 6, saturatedFat: 1, monounsaturatedFat: 2.5, polyunsaturatedFat: 2, omega3: 0, omega6: 0, carbs: 20, sugar: 10, protein: 3, fiber: 2, iron: 4, potassium: 0, category: "grains" },
            "Bagel (plain, 1)": { emoji: "ü•Ø", grams: 94, calories: 270, totalFat: 1, saturatedFat: 0.3, monounsaturatedFat: 0.3, polyunsaturatedFat: 0.2, omega3: 0, omega6: 0, carbs: 55, sugar: 3, protein: 11, fiber: 3, calcium: 10, potassium: 0, category: "grains" },
            "Muffin (blueberry, 1)": { emoji: "üßÅ", grams: 124, calories: 420, totalFat: 16, saturatedFat: 5, monounsaturatedFat: 6, polyunsaturatedFat: 3, omega3: 0, omega6: 0, carbs: 61, sugar: 30, protein: 5, fiber: 2, calcium: 10, potassium: 190, category: "grains" }
        };

        // Daily Values
        let dailyValues = {
              calories: 2000,
              protein: 50,
              carbs: 300,
              fat: 65,
              fiber: 25,
              omega3: 1.6, // In grams
              omega6: 17, // In grams
              calcium: 1000,
              magnesium: 420,
              potassium: 4700,
              iron: 18,
              zinc: 11,
              selenium: 55,
              sodium: 2300,
              vitaminA: 900,
              vitaminB12: 2.4,
              vitaminC: 90,
              vitaminD: 20,
              vitaminE: 15,
              vitaminK: 120
          };

        const buttonContainer = document.getElementById('foodButtons');
        const selectedFoodsContainer = document.getElementById('selectedFoods');
        const toggleButtons = document.querySelectorAll('.toggle-button');

        let selectedFoods = new Set();

        // Create food buttons with data-food attribute for accurate mapping
        for (let food in foodData) {
            let button = document.createElement('button');
            button.textContent = `${foodData[food].emoji} ${food}`;
            button.className = 'food-button';
            button.dataset.category = foodData[food].category;
            button.dataset.food = food; // Add data-food attribute
            button.onclick = () => toggleFood(food, button);
            buttonContainer.appendChild(button);
        }

        toggleButtons.forEach(button => {
            button.addEventListener('click', () => {
                const category = button.dataset.category;
                toggleButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');

                const foodButtons = document.querySelectorAll('.food-button');
                foodButtons.forEach(foodButton => {
                    const foodCategory = foodButton.dataset.category;
                    if (category === 'all' || foodCategory === category) {
                        foodButton.style.display = 'inline-block';
                    } else {
                        foodButton.style.display = 'none';
                    }
                });
                updateNutritionTable();
            });
        });

        function toggleFood(food, button) {
            if (selectedFoods.has(food)) {
                selectedFoods.delete(food);
                button.classList.remove('active');
                removeSlider(food);
            } else {
                selectedFoods.add(food);
                button.classList.add('active');
                addSlider(food);
            }
            updateNutritionTable();
        }

        function addSlider(food) {
            const div = document.createElement('div');
            div.className = 'food-item';
            div.innerHTML = `
                <label>${foodData[food].emoji} ${food}</label>
                <input type="range" min="0" max="500" value="${foodData[food].grams}" id="${sanitizeID(food)}-slider">
                <span id="${sanitizeID(food)}-value">${foodData[food].grams}g</span>
            `;
            selectedFoodsContainer.appendChild(div);

            const slider = document.getElementById(`${sanitizeID(food)}-slider`);
            const output = document.getElementById(`${sanitizeID(food)}-value`);
            slider.oninput = function () {
                output.textContent = this.value + 'g';
                updateNutritionTable();
            }
        }

        function removeSlider(food) {
            const slider = document.getElementById(`${sanitizeID(food)}-slider`);
            if (slider) {
                slider.parentElement.remove();
            }
        }

        function sanitizeID(str) {
            return str.replace(/[^a-zA-Z0-9]/g, '_');
        }

        function updateNutritionTable() {
            if (selectedFoods.size === 0) {
                resetProgressBars();
                return;
            }

            // Retrieve target values
            const targetCalories = parseFloat(document.getElementById('targetCalories').value) || dailyValues.calories;
            const targetProtein = parseFloat(document.getElementById('targetProtein').value) || dailyValues.protein;
            const targetFiber = parseFloat(document.getElementById('targetFiber').value) || dailyValues.fiber;

            let totals = {
                calories: 0, totalFat: 0, saturatedFat: 0,
                unsaturatedFat: 0, omega3: 0, omega6: 0,
                carbs: 0, sugar: 0, protein: 0, fiber: 0,
                vitaminA: 0, vitaminB12: 0, vitaminC: 0, vitaminD: 0, vitaminE: 0, vitaminK: 0,
                calcium: 0, magnesium: 0, potassium: 0, iron: 0, zinc: 0, selenium: 0, sodium: 0
            };

            // Track contributors for vitamins and minerals
            let nutrientContributors = {
                vitaminA: {},
                vitaminB12: {},
                vitaminC: {},
                vitaminD: {},
                vitaminE: {},
                vitaminK: {},
                calcium: {},
                magnesium: {},
                potassium: {},
                iron: {},
                zinc: {},
                selenium: {},
                sodium: {}
            };

            selectedFoods.forEach(food => {
                const sliderValue = parseFloat(document.getElementById(`${sanitizeID(food)}-slider`).value);
                const ratio = sliderValue / foodData[food].grams;
                for (let nutrient in totals) {
                    if (foodData[food][nutrient] !== undefined) {
                        totals[nutrient] += foodData[food][nutrient] * ratio;
                        // Track contributors for vitamins and minerals
                        if (nutrientContributors[nutrient] !== undefined) {
                            if (!nutrientContributors[nutrient][food]) {
                                nutrientContributors[nutrient][food] = 0;
                            }
                            nutrientContributors[nutrient][food] += foodData[food][nutrient] * ratio;
                        }
                    }
                }
            });

            // Update Macronutrient Circles
            updateMacroCircles(totals, targetCalories, targetProtein, targetFiber);

            // Update Vitamins and Minerals Progress Bars
            updateVitaminsAndMinerals(totals, nutrientContributors);
        }

        function updateMacroCircles(totals, targetCalories, targetProtein, targetFiber) {
            // Calories
            const caloriesProgress = Math.min((totals.calories / targetCalories) * 100, 100);
            const caloriesCircle = document.getElementById('caloriesProgress');
            const caloriesText = document.getElementById('caloriesText');
            if (caloriesCircle && caloriesText) {
                caloriesCircle.style.setProperty('--progress', caloriesProgress);
                caloriesText.textContent = `${caloriesProgress.toFixed(0)}%`;
            }

            // Protein
            const proteinProgress = Math.min((totals.protein / targetProtein) * 100, 100);
            const proteinCircle = document.getElementById('proteinProgress');
            const proteinText = document.getElementById('proteinText');
            if (proteinCircle && proteinText) {
                proteinCircle.style.setProperty('--progress', proteinProgress);
                proteinText.textContent = `${proteinProgress.toFixed(0)}%`;
            }

            // Carbs
            const carbsProgress = Math.min((totals.carbs / dailyValues.carbs) * 100, 100);
            const carbsCircle = document.getElementById('carbsProgress');
            const carbsText = document.getElementById('carbsText');
            const carbsSub = document.getElementById('carbsSubNutrients');
            if (carbsCircle && carbsText && carbsSub) {
                carbsCircle.style.setProperty('--progress', carbsProgress);
                carbsText.textContent = `${carbsProgress.toFixed(0)}%`;
                carbsSub.textContent = `Sugar: ${totals.sugar.toFixed(1)}g | Fiber: ${totals.fiber.toFixed(1)}g`;
            }

            // Fat
            const fatProgress = Math.min((totals.totalFat / dailyValues.fat) * 100, 100);
            const fatCircle = document.getElementById('fatProgress');
            const fatText = document.getElementById('fatText');
            const fatSub = document.getElementById('fatSubNutrients');
            if (fatCircle && fatText && fatSub) {
                fatCircle.style.setProperty('--progress', fatProgress);
                fatText.textContent = `${fatProgress.toFixed(0)}%`;
                fatSub.textContent = `Sat: ${totals.saturatedFat.toFixed(1)}g | Unsat: ${totals.unsaturatedFat.toFixed(1)}g | Omega-3: ${totals.omega3.toFixed(1)}g | Omega-6: ${totals.omega6.toFixed(1)}g`;
            }
        }

        function updateVitaminsAndMinerals(totals, nutrientContributors) {
            // Vitamins
            const vitamins = ['vitaminA', 'vitaminB12', 'vitaminC', 'vitaminD', 'vitaminE', 'vitaminK'];
            vitamins.forEach(vitamin => {
                const progressBar = document.getElementById(`${vitamin}ProgressBar`);
                const topContributorsDiv = document.getElementById(`${vitamin}Top`);
                if (progressBar && topContributorsDiv) {
                    const current = totals[vitamin];
                    const total = dailyValues[vitamin];
                    const progress = Math.min((current / total) * 100, 100);
                    const fill = progressBar.querySelector('.progress-bar-fill');
                    fill.style.width = `${progress}%`;
                    progressBar.setAttribute('data-value', progress.toFixed(0));
                    progressBar.setAttribute('data-current', current.toFixed(1));
                    progressBar.setAttribute('data-total', total);

                    // Get top 3 contributors
                    const contributors = nutrientContributors[vitamin];
                    const sortedContributors = Object.entries(contributors)
                        .sort((a, b) => b[1] - a[1])
                        .slice(0, 3);
                    
                    // Build contributors display
                    let contributorsHTML = '';
                    sortedContributors.forEach(([food, value]) => {
                        contributorsHTML += `<span>${foodData[food].emoji} ${value.toFixed(1)}</span>`;
                    });
                    topContributorsDiv.innerHTML = contributorsHTML;
                }
            });

            // Minerals
            const minerals = ['calcium', 'magnesium', 'potassium', 'iron', 'zinc', 'selenium', 'sodium'];
            minerals.forEach(mineral => {
                const progressBar = document.getElementById(`${mineral}ProgressBar`);
                const topContributorsDiv = document.getElementById(`${mineral}Top`);
                if (progressBar && topContributorsDiv) {
                    const current = totals[mineral];
                    const total = dailyValues[mineral];
                    const progress = Math.min((current / total) * 100, 100);
                    const fill = progressBar.querySelector('.progress-bar-fill');
                    fill.style.width = `${progress}%`;
                    progressBar.setAttribute('data-value', progress.toFixed(0));
                    progressBar.setAttribute('data-current', current.toFixed(1));
                    progressBar.setAttribute('data-total', total);

                    // Get top 3 contributors
                    const contributors = nutrientContributors[mineral];
                    const sortedContributors = Object.entries(contributors)
                        .sort((a, b) => b[1] - a[1])
                        .slice(0, 3);
                    
                    // Build contributors display
                    let contributorsHTML = '';
                    sortedContributors.forEach(([food, value]) => {
                        contributorsHTML += `<span>${foodData[food].emoji} ${value.toFixed(1)}</span>`;
                    });
                    topContributorsDiv.innerHTML = contributorsHTML;
                }
            });
        }

        function resetProgressBars() {
            // Reset progress circles
            const progressCircles = document.querySelectorAll('.progress-circle');
            progressCircles.forEach(circle => {
                circle.style.setProperty('--progress', 0);
                const text = circle.querySelector('.progress-text');
                if (text) text.textContent = '0%';
            });

            // Reset sub-nutrients info
            document.getElementById('carbsSubNutrients').textContent = `Sugar: 0g | Fiber: 0g`;
            document.getElementById('fatSubNutrients').textContent = `Sat: 0g | Unsat: 0g | Omega-3: 0g | Omega-6: 0g`;

            // Reset progress bars
            const progressBars = document.querySelectorAll('.progress-bar');
            progressBars.forEach(bar => {
                const fill = bar.querySelector('.progress-bar-fill');
                fill.style.width = '0%';
                bar.setAttribute('data-value', '0');
                bar.setAttribute('data-current', '0');
                bar.setAttribute('data-total', bar.getAttribute('data-total'));
            });

            // Clear top contributors
            const topContributors = document.querySelectorAll('.top-contributors');
            topContributors.forEach(div => div.innerHTML = '');
        }

        // Initialize the dashboard
        updateNutritionTable();

        // Search functionality
        const searchInput = document.getElementById('foodSearch');

        searchInput.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            const foodButtons = document.querySelectorAll('.food-button');
            
            foodButtons.forEach(button => {
                const foodName = button.dataset.food.toLowerCase();
                if (foodName.includes(searchTerm)) {
                    button.style.display = 'inline-block';
                } else {
                    button.style.display = 'none';
                }
            });
        });

        // Target Inputs functionality
        const targetCaloriesInput = document.getElementById('targetCalories');
        const targetProteinInput = document.getElementById('targetProtein');
        const targetFiberInput = document.getElementById('targetFiber');

        targetCaloriesInput.addEventListener('input', updateNutritionTable);
        targetProteinInput.addEventListener('input', updateNutritionTable);
        targetFiberInput.addEventListener('input', updateNutritionTable);
    </script>
</body>
</html>
