<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MangiaFortissimo</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f4f4;
        }

        h1, h2 {
            color: #2c3e50;
        }

        #foodSearch {
            padding: 10px 15px;
            border: none;
            border-radius: 20px;
            background-color: #f0f0f0;
            margin-bottom: 20px;
            font-size: 16px;
            width: 100%;
            max-width: 400px;
        }

        .toggle-buttons {
            display: flex;
            justify-content: flex-start;
            flex-wrap: nowrap;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
        }

        .toggle-button {
            padding: 10px 15px;
            background-color: #f0f0f0;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: background-color 0.3s;
            flex-shrink: 0;
        }

        .toggle-button.active {
            background-color: #3498db;
            color: white;
        }

        #foodButtons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .food-button {
            padding: 10px 15px;
            background-color: #f0f0f0;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .food-button.active {
            background-color: #2ecc71;
            color: white;
        }

        #selectedFoods {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .food-item {
            background-color: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .food-item label {
            display: block;
            margin-bottom: 5px;
        }

        .food-item input[type="range"] {
            width: 100%;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
        }

        .progress-section {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            text-align: center;
        }

        .progress-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            position: relative;
            margin: 0 auto;
            background: conic-gradient(#3498db calc(var(--progress) * 1%), #e0e0e0 0%);
        }

        .progress-circle::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 10px;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: #fff;
        }

        .progress-circle .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #555;
            font-size: 18px;
            font-weight: bold;
        }

        .progress-bar-section {
            grid-column: 1 / -1;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .progress-bar-section h2 {
            margin-bottom: 15px;
        }

        .progress-bar {
            position: relative;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 10px;
            overflow: hidden;
        }

        .progress-bar::before {
            content: attr(data-label);
            position: absolute;
            left: 10px;
            top: -25px;
            color: #333;
            font-size: 14px;
        }

        .progress-bar::after {
            content: attr(data-value) "%";
            position: absolute;
            right: 10px;
            top: -25px;
            color: #333;
            font-size: 14px;
        }

        .progress-bar-fill {
            background-color: #3498db;
            height: 100%;
            border-radius: 10px;
            width: 0%;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            font-size: 14px;
            color: #777;
        }

        footer a {
            color: #3498db;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <h1>MangiaFortissimo</h1>
    <input type="text" id="foodSearch" placeholder="Search foods...">

    <div class="toggle-buttons">
        <button class="toggle-button active" data-category="all">All üçé</button>
        <button class="toggle-button" data-category="fruits">Fruits üçì</button>
        <button class="toggle-button" data-category="vegetables">Vegetables ü•¶</button>
        <button class="toggle-button" data-category="dairy">Dairy ü•õ</button>
        <button class="toggle-button" data-category="grains">Grains üåæ</button>
        <button class="toggle-button" data-category="protein">Protein ü•©</button>
        <button class="toggle-button" data-category="others">Others üçï</button>
    </div>

    <div id="foodButtons"></div>
    <div id="selectedFoods"></div>

    <div class="dashboard">
        <div class="progress-section">
            <h2>Calories</h2>
            <div id="caloriesProgress" class="progress-circle" data-label="Calories">
                <div class="progress-text" id="caloriesText">0%</div>
            </div>
        </div>
        <div class="progress-section">
            <h2>Protein</h2>
            <div id="proteinProgress" class="progress-circle" data-label="Protein">
                <div class="progress-text" id="proteinText">0%</div>
            </div>
        </div>
        <div class="progress-section">
            <h2>Carbs</h2>
            <div id="carbsProgress" class="progress-circle" data-label="Carbs">
                <div class="progress-text" id="carbsText">0%</div>
            </div>
        </div>
        <div class="progress-section">
            <h2>Fat</h2>
            <div id="fatProgress" class="progress-circle" data-label="Fat">
                <div class="progress-text" id="fatText">0%</div>
            </div>
        </div>
    </div>

    <div class="progress-bar-section">
        <h2>Vitamins</h2>
        <div class="progress-bar" id="vitaminAProgressBar" data-label="Vitamin A">
            <div class="progress-bar-fill"></div>
        </div>
        <div class="progress-bar" id="vitaminB12ProgressBar" data-label="Vitamin B12">
            <div class="progress-bar-fill"></div>
        </div>
        <div class="progress-bar" id="vitaminCProgressBar" data-label="Vitamin C">
            <div class="progress-bar-fill"></div>
        </div>
        <div class="progress-bar" id="vitaminDProgressBar" data-label="Vitamin D">
            <div class="progress-bar-fill"></div>
        </div>
        <div class="progress-bar" id="vitaminEProgressBar" data-label="Vitamin E">
            <div class="progress-bar-fill"></div>
        </div>
        <div class="progress-bar" id="vitaminKProgressBar" data-label="Vitamin K">
            <div class="progress-bar-fill"></div>
        </div>
    </div>

    <div class="progress-bar-section">
        <h2>Minerals</h2>
        <div class="progress-bar" id="calciumProgressBar" data-label="Calcium">
            <div class="progress-bar-fill"></div>
        </div>
        <div class="progress-bar" id="magnesiumProgressBar" data-label="Magnesium">
            <div class="progress-bar-fill"></div>
        </div>
        <div class="progress-bar" id="potassiumProgressBar" data-label="Potassium">
            <div class="progress-bar-fill"></div>
        </div>
        <div class="progress-bar" id="ironProgressBar" data-label="Iron">
            <div class="progress-bar-fill"></div>
        </div>
        <div class="progress-bar" id="zincProgressBar" data-label="Zinc">
            <div class="progress-bar-fill"></div>
        </div>
        <div class="progress-bar" id="seleniumProgressBar" data-label="Selenium">
            <div class="progress-bar-fill"></div>
        </div>
        <div class="progress-bar" id="sodiumProgressBar" data-label="Sodium">
            <div class="progress-bar-fill"></div>
        </div>
    </div>

    <footer>
        <p>micmer - <a href="https://linktr.ee/micmer">https://linktr.ee/micmer</a></p>
    </footer>

    <script>
        const foodData = {
            // ... (Keep your existing food data here)
        };

        const dailyValues = {
            calories: 2000,
            protein: 50,
            carbs: 300,
            fat: 65,
            fiber: 25,
            omega3: 1.6 * 1000, // Convert grams to mg
            omega6: 17 * 1000, // Convert grams to mg
            calcium: 1000,
            magnesium: 420,
            potassium: 4700,
            iron: 18,
            zinc: 11,
            selenium: 55,
            sodium: 2300,
            vitaminA: 900,
            vitaminB12: 2.4,
            vitaminC: 90,
            vitaminD: 20,
            vitaminE: 15,
            vitaminK: 120
        };

        const buttonContainer = document.getElementById('foodButtons');
        const selectedFoodsContainer = document.getElementById('selectedFoods');
        const toggleButtons = document.querySelectorAll('.toggle-button');

        let selectedFoods = new Set();

        // Create food buttons
        for (let food in foodData) {
            let button = document.createElement('button');
            button.textContent = `${foodData[food].emoji} ${food}`;
            button.className = 'food-button';
            button.dataset.category = foodData[food].category;
            button.onclick = () => toggleFood(food, button);
            buttonContainer.appendChild(button);
        }

        toggleButtons.forEach(button => {
            button.addEventListener('click', () => {
                const category = button.dataset.category;
                toggleButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');

                const foodButtons = document.querySelectorAll('.food-button');
                foodButtons.forEach(foodButton => {
                    const foodName = foodButton.textContent.split(' ').slice(1).join(' ');
                    if (category === 'all' || foodData[foodName].category === category) {
                        foodButton.style.display = 'inline-block';
                    } else {
                        foodButton.style.display = 'none';
                    }
                });
                updateNutritionTable();
            });
        });

        function toggleFood(food, button) {
            if (selectedFoods.has(food)) {
                selectedFoods.delete(food);
                button.classList.remove('active');
                removeSlider(food);
            } else {
                selectedFoods.add(food);
                button.classList.add('active');
                addSlider(food);
            }
            updateNutritionTable();
        }

        function addSlider(food) {
            const div = document.createElement('div');
            div.className = 'food-item';
            div.innerHTML = `
                <label>${foodData[food].emoji} ${food}</label>
                <input type="range" min="0" max="500" value="${foodData[food].grams}" id="${food}-slider">
                <span id="${food}-value">${foodData[food].grams}g</span>
            `;
            selectedFoodsContainer.appendChild(div);

            const slider = document.getElementById(`${food}-slider`);
            const output = document.getElementById(`${food}-value`);
            slider.oninput = function () {
                output.textContent = this.value + 'g';
                updateNutritionTable();
            }
        }

        function removeSlider(food) {
            const slider = document.getElementById(`${food}-slider`);
            if (slider) {
                slider.parentElement.remove();
            }
        }

        function updateNutritionTable() {
            if (selectedFoods.size === 0) {
                resetProgressBars();
                return;
            }

            let totals = {
                calories: 0, totalFat: 0, saturatedFat: 0,
                carbs: 0, protein: 0, fiber: 0, omega3: 0, omega6: 0,
                vitaminA: 0, vitaminB12: 0, vitaminC: 0, vitaminD: 0, vitaminE: 0, vitaminK: 0,
                calcium: 0, magnesium: 0, potassium: 0, iron: 0, zinc: 0, selenium: 0, sodium: 0
            };

            selectedFoods.forEach(food => {
                const sliderValue = document.getElementById(`${food}-slider`).value;
                const ratio = sliderValue / foodData[food].grams;
                for (let nutrient in totals) {
                    if (foodData[food][nutrient]) {
                        totals[nutrient] += foodData[food][nutrient] * ratio;
                    }
                }
            });

            updateProgressBars(totals);
        }

        function updateProgressBars(totals) {
            // Update progress circles
            const circleIds = ['calories', 'protein', 'carbs', 'fat'];
            circleIds.forEach(id => {
                const progress = Math.min((totals[id] / dailyValues[id]) * 100, 100);
                const progressCircle = document.getElementById(`${id}Progress`);
                if (progressCircle) {
                    progressCircle.style.setProperty('--progress', progress);
                    document.getElementById(`${id}Text`).textContent = progress.toFixed(0) + '%';
                }
            });

            // Update progress bars for vitamins
            const vitaminIds = ['vitaminA', 'vitaminB12', 'vitaminC', 'vitaminD', 'vitaminE', 'vitaminK'];
            vitaminIds.forEach(vitamin => {
                const progressBar = document.getElementById(`${vitamin}ProgressBar`);
                if (progressBar) {
                    const progress = Math.min((totals[vitamin] / dailyValues[vitamin]) * 100, 100);
                    const fill = progressBar.querySelector('.progress-bar-fill');
                    fill.style.width = progress + '%';
                    progressBar.setAttribute('data-value', progress.toFixed(0));
                }
            });

            // Update progress bars for minerals
            const mineralIds = ['calcium', 'magnesium', 'potassium', 'iron', 'zinc', 'selenium', 'sodium'];
            mineralIds.forEach(mineral => {
                const progressBar = document.getElementById(`${mineral}ProgressBar`);
                if (progressBar) {
                    const progress = Math.min((totals[mineral] / dailyValues[mineral]) * 100, 100);
                    const fill = progressBar.querySelector('.progress-bar-fill');
                    fill.style.width = progress + '%';
                    progressBar.setAttribute('data-value', progress.toFixed(0));
                }
            });
        }

        function resetProgressBars() {
            const progressCircles = document.querySelectorAll('.progress-circle');
            progressCircles.forEach(circle => {
                circle.style.setProperty('--progress', 0);
                circle.querySelector('.progress-text').textContent = '0%';
            });

            const progressBars = document.querySelectorAll('.progress-bar');
            progressBars.forEach(bar => {
                const fill = bar.querySelector('.progress-bar-fill');
                fill.style.width = '0%';
                bar.setAttribute('data-value', '0');
            });
        }

        // Initialize the dashboard
        updateNutritionTable();

        // Search functionality
        const searchInput = document.getElementById('foodSearch');

        searchInput.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            const foodButtons = document.querySelectorAll('.food-button');
            
            foodButtons.forEach(button => {
                const foodName = button.textContent.toLowerCase();
                if (foodName.includes(searchTerm)) {
                    button.style.display = 'inline-block';
                } else {
                    button.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>
